# Meeting Assistant

Утилита для записи, транскрибации и суммаризации встреч (созвонов) на macOS.

## Возможности

- **Запись аудио**: Захват системного звука и микрофона (через Aggregate Device).
- **Транскрибация**: Использование Deepgram Nova-2 для точного перевода речи в текст с поддержкой русского языка.
- **Диаризация**: Автоматическое разделение спикеров в тексте.
- **Суммаризация**: Генерация итогов встречи (ключевые темы, решения, задачи) с помощью Google Gemini Flash.
- **Web API (OpenAPI/Swagger)**: Интерактивный интерфейс для загрузки файлов и получения результатов через браузер.
- **Два формата вывода**: Полный лог (`transcript.md`) и краткие итоги (`summary.md`).
- **Обработка готовых файлов**: Возможность транскрибировать уже существующие `.wav` файлы через CLI или API.

## Требования

- **macOS** (проверено на Apple Silicon).
- **Python 3.9+**
- **BlackHole** или аналогичный аудио-драйвер для захвата системного звука.
- **API Ключи**:
    - [Deepgram API Key](https://console.deepgram.com/)
    - [Gemini API Key](https://aistudio.google.com/)

## Установка

1. Склонируйте репозиторий.
2. Создайте виртуальное окружение и установите зависимости:
   ```bash
   python -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   ```
3. Создайте файл `.env` в корне проекта:
   ```env
   DEEPGRAM_API_KEY=ваш_ключ_deepgram
   GEMINI_API_KEY=ваш_ключ_gemini
   ```

## Настройка аудио (macOS)

Для одновременной записи вашего микрофона и звука собеседников (системного звука):

1. Установите [BlackHole 2ch](https://github.com/ExistentialAudio/BlackHole).
2. Откройте **Настройка Audio-MIDI** (Audio MIDI Setup).
3. Создайте **Агрегатное устройство** (Aggregate Device) с именем `Unit` (или измените имя в `core/recorder.py`).
4. Включите в него ваш микрофон и BlackHole.
5. Убедитесь, что BlackHole выбран как устройство вывода в macOS или в приложении для созвонов.

## Использование

### Web API + Swagger (Рекомендуется)
Для запуска сервера с интерактивной документацией:
```bash
python api.py
```
После запуска откройте [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) в браузере. Там можно загрузить аудиофайл и сразу получить транскрипт и саммари.

### CLI: Запись новой встречи
Запустите скрипт, и он начнет запись через устройство `Unit`. Нажмите **Ctrl+C**, чтобы остановить запись и начать обработку.
```bash
python main.py
```

### CLI: Обработка существующего файла
Если у вас уже есть запись в формате `.wav`:
```bash
python main.py -f /путь/к/файлу.wav
```

## Структура проекта

- `main.py` — точка входа для консольного режима.
- `api.py` — запуск FastAPI-сервера с Swagger UI.
- `core/recorder.py` — логика записи аудио.
- `core/processor.py` — интеграция с Deepgram и парсинг транскрипта.
- `core/summarizer.py` — генерация итогов через Gemini.
- `output/` — папка с результатами (группируются по дате и времени).

## Особенности реализации

- **Diarization**: Скрипт использует `diarize=true` в Deepgram, что позволяет точно определять, кто и когда говорил.
- **Smart Format**: Включено автоматическое форматирование (пунктуация, числа).
- **Error Handling**: Корректно обрабатывает прерывание записи, предотвращая повреждение аудио-файлов.
